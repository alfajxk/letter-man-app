<% include ../partials/header %>

<div class="container list">
  <div class="row justify-content-around"> 
    <div class="col-10"> 
      <div class="text-center">
        <h1>Show Details</h1>
        <p>
        <a class="btn btn-primary btn-lg btn-block" href="/noms">List Outgoing Notes of Meeting</a>
      </p>
      </div>
    </div> 
  </div>
</div>


<div class="container">
  <div class="row justify-content-around">
  <div class=col-10>
    <form>
        
      <div class="container">
        <div class="form-group">
          <input class="form-control" type="hidden" name="nom[counter]" value="<%= nom.counter %>">
        </div>
        <div class="form-group">
          <input class="form-control" type="hidden" name="nom[prefix]" value="<%= nom.prefix %>">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-4">
          <!-- Number -->
          <label>Number</label>
            <div class="input-group">
              <span class="input-group-addon"><i class="fa fa-telegram"></i></span>
              <input class="form-control form-control-md" type="text" name="nom[ltrNmbr]" id="nmbr" value="<%= nom.ltrNmbr %>" readonly>
            </div>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-3">
          <label>Date</label>
            <div class="input-group">
              <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
              <input class="form-control form-control-md" id="nowdate" type="text" name="nom[date]" value="<%= nom.date %>" readonly>
            </div>
        </div>
        <div class="form-group col-5">
          <label>Debtor</label>
            <div class="input-group">
              <span class="input-group-addon"><i class="fa fa-user"></i></span>
              <input class="form-control form-control-md case" type="text" name="nom[debtor]" value="<%= nom.debtor %>" readonly>
            </div>
        </div>
        <div class="form-group col-4">
          <label>Proposer</label>
            <div class="input-group">
              <span class="input-group-addon"><i class="fa fa-user-circle"></i></span>
              <input class="form-control form-control-md case" type="text" name="nom[proposer]" value="<%= nom.proposer %>" readonly>
            </div>
        </div>
      </div>
      <div class="form-inline mb-2 mt-2">
        <label for="nom[segment]" class="mr-sm-2 mb-2">Segment Type: </label>
          <select disabled name="nom[segment]" class="custom-select mb-2 mr-sm-5">
            <% if (nom.segment == "BBG") { %>
            <option name="nom[segment]" value="BBG" selected>BBG</option>
            <% } else if (nom.segment == "CHG") { %>
            <option name="nom[segment]" value="CHG" selected>CHG (Consumer)</option>
            <% } else if (nom.segment == "MBG") { %>
            <option name="nom[segment]" value="MBG" selected>MBG (Micro)</option>
            <% } else if (nom.segment == "PWG") { %>
            <option name="nom[segment]" value="PWG" selected>PWG</option>
            <% } else { %>
            <option name="nom[segment]" value="CMG" selected>CMG (Wholesale)</option>
            <% } %>
          </select>
        <label for="nom[type]" class="mr-sm-2 mb-2">Financing Type: </label>
          <select disabled name="nom[type]" class="custom-select mb-2 mr-sm-2">
            <% if (nom.type == "New") { %>
            <option name="nom[type]" value="New" selected>New</option>
            <% } else if (nom.type == "Prolongation") { %>
            <option name="nom[type]" value="Prolongation" selected>Prolongation (Perpanjangan)</option>
            <% } else if (nom.type == "Increment") { %>
            <option name="nom[type]" value="Increment" selected>Increment (Top Up/Penambahan)</option>
            <% } else if (nom.type == "Restructure") { %>
            <option name="nom[type]" value="Restructure" selected>Restructure</option>
            <% } else if (nom.type == "Settled") { %>
            <option name="nom[type]" value="Settled" selected>Settled (Pelunasan)</option>
            <% } else if (nom.type == "Auction") { %>
            <option name="nom[type]" value="Auction" selected>Auction (Lelang)</option>
            <% } else if (nom.type == "Redemption") { %>
            <option name="nom[type]" value="Redemption" selected>Redemption (Penebusan)</option>
            <% } else if (nom.type == "Booking") { %>
            <option name="nom[type]" value="Booking" selected>Booking (Pencairan Plafond)</option>
            <% } else if (nom.type == "Descended") { %>
            <option name="nom[type]" value="Descended" selected>Descended Quality (Turun Kualitas/di WO)</option>
            <% } else { %>
            <option name="nom[type]" value="Refinancing" selected>Refinancing</option>
            <% } %>
          </select>
      </div>
      <div class="form-row">
        <div class="form-group col-6">
          <label>Outstanding (OS Pokok diajukan/Sisa OS Pokok)</label>
            <div class="input-group">
              <span class="input-group-addon">Rp.</span>
              <input class="form-control form-control-md inputNumberDot" type="text" name="nom[outstanding]" value="<%= nom.outstanding %>" readonly>
            </div>
        </div>
        <div class="form-group col-6">
          <label>Exposure (Total OS Pokok)</label>
            <div class="input-group">
              <span class="input-group-addon">Rp.</span>
              <input class="form-control form-control-md inputNumberDot" type="text" name="nom[exposure]" value="<%= nom.exposure %>" readonly>
            </div>
        </div>
      </div>
      <div class="form-inline mb-2 mt-2">
        <label for="nom[level]" class="mr-sm-2 mb-2">Committee Level: </label>
          <select disabled name="nom[level]" class="custom-select mb-2 mr-sm-5">
            <% if (nom.level == "C3") { %>
            <option name="nom[level]" value="C3" selected>C3</option>
            <% } else if (nom.level == "B1") { %>
            <option name="nom[level]" value="B1" selected>B1</option>
            <% } else if (nom.level == "B2") { %>
            <option name="nom[level]" value="B2" selected>B2</option>
            <% } else if (nom.level == "A1") { %>
            <option name="nom[level]" value="A1" selected>A1</option>
            <% } else { %>
            <option name="nom[level]" value="A2" selected>A2</option>
            <% } %>
          </select> 
        <label for="nom[area]" class="mr-sm-2 mb-2">Area:  </label>
          <select disabled name="nom[area]" id="area" class="custom-select mb-2 mr-sm-2">
            <% if (nom.area == "Bandung Ahmad Yani") { %>
            <option name="nom[area]" value="Bandung Ahmad Yani" selected>Bandung Ahmad Yani</option>
            <% } else if (nom.area == "Bandung Dago") { %>
            <option name="nom[area]" value="Bandung Dago" selected>Bandung Dago</option>
            <% } else if (nom.area == "Cirebon") { %>
            <option name="nom[area]" value="Cirebon" selected>Cirebon</option>
            <% } else if (nom.area == "Semarang") { %>
            <option name="nom[area]" value="Semarang" selected>Semarang</option>
            <% } else if (nom.area == "Solo") { %>
            <option name="nom[area]" value="Solo" selected>Solo</option>
            <% } else { %>
            <option name="nom[area]" value="Yogyakarta" selected>Yogyakarta</option>
            <% } %>
          </select>
      </div>
      <div class="form-row">
        <div class="form-group col-6">
          <label>Author 1 (Pemutus 1)</label>
            <div class="input-group">
              <span class="input-group-addon"><i class="fa fa-users"></i></span>
              <input class="form-control form-control-md case" type="text" name="nom[author1]" value="<%= nom.author1 %>" readonly>
            </div>
        </div>
        <div class="form-group col-6">
          <label>Author 2 (Pemutus 2)</label>
            <div class="input-group">
              <span class="input-group-addon"><i class="fa fa-users"></i></span>
              <input class="form-control form-control-md case" type="text" name="nom[author2]" value="<%= nom.author2 %>" readonly>
            </div>
        </div>
      </div>
      <div class="form-row">
        <div class="col-6 form-group">
          <label>Location (Tempat RKP)</label>
          <div class="input-group">
            <span class="input-group-addon"><i class="fa fa-map-marker"></i></span>
            <input class="form-control form-control-md case" type="text" name="nom[place]" value="<%= nom.place %>" readonly>
          </div>
        </div>
        <div class="col-3 form-group">
          <label>Note Number (Nomor NAP)</label>
          <div class="input-group">
            <span class="input-group-addon"><i class="fa fa-clipboard"></i></span>
            <input class="form-control form-control-md upper" type="text" name="nom[noteNmbr]" value="<%= nom.noteNmbr %>" readonly>
          </div>
        </div>
        <div class="col-3 form-group">
          <label>Note Date (Tanggal NAP)</label>
          <div class="input-group">
            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
            <input class="form-control form-control-md date" type="text" name="nom[noteDate]" value="<%= nom.noteDate %>" readonly>
          </div>
        </div>
      </div>
      <div class="form-group" style="margin-right:70%;">
				<label>Archive Code:</label>
					<div class="input-group">
						<span class="input-group-addon"><i class="fa fa-archive"></i></span>
						<input class="form-control form-control-md upper" type="text" name="nom[archive]" value="<%= nom.archive %>" readonly>
					</div>	
			</div>
      <div class="form-group">
        <label>Remark (Penjelasan)</label>
        <textarea class="form-control form-control-md case" rows="2" name="nom[remark]" readonly><%= nom.remark %></textarea>
      </div>  
      <div>
      <!-- USER INPUT -->
        <input class="form-control form-control-md" type="hidden" name="nom[user]" readonly value="<%= nom.user %>">
      </div>
    </form>
    <div class="container table-list">
      <div class="row justify-content-center">
        <div class="scrollme table-responsive">
          <% if (nom.documents == null || nom.documents == undefined || nom.documents.length == 0) { %>
          <% } else { %>
          <table class="table table-striped table-hover table-sm" id="tbid">
            <thead class="thead-dark text-center">
              <tr>
                <th class="text-left" style="width:30em">Documents</th>
                <% if (nom.user.toLowerCase() == currentUser.fullname.toLowerCase() || currentUser.role == "admin") { %>
                <th style="width:5em">Show File</th>
                <th style="width:5em">Delete File</th>
                <% } else { %>
                <th style="width:5em">Show File</th>
                <% } %>
              </tr>
            </thead>
            <tbody>
              <tr>
                <% nom.documents.forEach(function(document){ %>
                <td style="width:30em"><%= document.filename %></td>
                <% if (nom.user.toLowerCase() == currentUser.fullname.toLowerCase() || currentUser.role == "admin") { %>
                <td style="width:5em" class="text-center"><a href="/noms/<%= nom._id%>/documents/<%=document._id %>" target="_blank" class="btn btn-primary btn-sm"><span class="fa fa-external-link"></span> Show</a></td>
                <form action="/noms/<%=nom._id%>/documents/<%=document._id%>?_method=DELETE" method="POST">
                <td style="width:5em" class="text-center"><button class="btn btn-danger btn-sm"><span class="fa fa-window-close"></span> Delete</button></form>
                </td>
                <% } else { %>
                <td style="width:5em" class="text-center"><a href="/noms/<%= nom._id%>/documents/<%=document._id %>" target="_blank" class="btn btn-primary btn-sm"><span class="fa fa-external-link"></span> Show</a></td>
                <% } %>
              </tr>
            </tbody>
            <% }) %>
          <% } %>
          </table>
        </div>
      </div>
    </div>
    </div>
      <div class="container row justify-content-center mx-auto">
        <% if (nom.user.toLowerCase() == currentUser.fullname.toLowerCase() || currentUser.role == "admin") { %>
        <a class="btn btn-primary mr-1" href="/noms/<%= nom._id %>/edit"><i class="fa fa-pencil-square-o"></i> Edit</a>
        <form action="/noms/<%= nom._id %>?_method=DELETE" method="POST">
          <button class="btn btn-danger ml-1 delete"><i class="fa fa-trash-o"></i> Delete</button>
        </form>
        <% } else { %>
        <a class="btn btn-primary mr-1" href="/noms/<%= nom._id %>/edit"><i class="fa fa-pencil-square-o"></i> Edit</a>
        <% } %>
  </div>
</div>

<!-- DELETE MODAL -->
<div class="modal fade" id="confirm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
              <h4 class="modal-title" id="myModalLabel">Confirm Delete</h4>
          </div>
          <div class="modal-body">
              <p>You are about to delete record, this procedure is irreversible.</p>
              <p>Do you want to proceed?</p>
          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-danger btn-ok" id="delete">Delete</button>
          </div>
      </div>
  </div>
</div>

<% include ../partials/footer %>
<% include ../functions/showfuncs %>

